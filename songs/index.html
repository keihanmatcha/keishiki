<!DOCTYPE html>
<html lang="ja">
<head>
Â  <meta charset="UTF-8" />
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <title>æ›²ãƒªã‚¹ãƒˆï¼ˆvideos.json å‚ç…§ / ã‚µã‚¤ãƒ‰ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ï¼‹ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆï¼‹ã‚¿ã‚°è¤‡æ•°ãƒ•ã‚£ãƒ«ã‚¿ï¼‰</title>
Â  <link rel="icon" href="images/favicon.ico" sizes="any">
Â  <link rel="icon" type="image/png" href="images/Nagao-icon.png" sizes="512x512">
Â  <link rel="apple-touch-icon" href="images/Nagao-icon.png">
Â  <link rel="canonical" href="https://keishiki.com/song/">

<meta property="og:site_name" content="æ™¯è­˜ï½œé•·å°¾æ™¯ æ›²æ¤œç´¢ã‚µã‚¤ãƒˆ">
<meta property="og:type" content="website">
<meta property="og:title" content="æ›²æ¤œç´¢ | æ™¯è­˜">
<meta property="og:description" content="é•·å°¾æ™¯ã®æ­Œæ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ›²åãƒ»ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåãƒ»ã‚¿ã‚°ã§æ¤œç´¢ã§ãã¾ã™ã€‚">
<meta property="og:url" content="https://keishiki.com/song/">
<meta property="og:image" content="https://keishiki.com/images/ogp.PNG">
<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="630">

<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="æ›²æ¤œç´¢ | æ™¯è­˜">
<meta name="twitter:description" content="é•·å°¾æ™¯ã®æ­Œæ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚’æ›²åãƒ»ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆåãƒ»ã‚¿ã‚°ã§æ¤œç´¢ã§ãã¾ã™ã€‚">
<meta name="twitter:image" content="https://keishiki.com/images/ogp.PNG">

Â  <style>
Â  Â  :root {
Â  Â  Â  --fg: #222;
Â  Â  Â  --muted: #6b7280;
Â  Â  Â  --accent: #625DA1;
Â  Â  Â  --bg: #fff;
Â  Â  Â  --border: #e5e7eb;
Â  Â  Â  --panel: #f8f8ff;
Â  Â  }
Â  Â  html, body {
Â  Â  Â  margin: 0;
Â  Â  Â  background: var(--bg);
Â  Â  Â  color: var(--fg);
Â  Â  Â  font-family: system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo, sans-serif;
Â  Â  }
Â  Â  header {
Â  Â  Â  position: sticky;
Â  Â  Â  top: 0;
Â  Â  Â  background: #fffcc;
Â  Â  Â  backdrop-filter: saturate(1.2) blur(6px);
Â  Â  Â  border-bottom: 1px solid var(--border);
Â  Â  }
Â  Â  .wrap {
Â  Â  Â  max-width: 1200px;
Â  Â  Â  margin-inline: auto;
Â  Â  Â  padding: 14px 16px;
Â  Â  }
Â  Â  h1 {
Â  Â  Â  margin: 0 0 8px;
Â  Â  Â  font-size: 20px;
Â  Â  }
Â  Â  .toolbar {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 12px;
Â  Â  Â  align-items: center;
Â  Â  Â  flex-wrap: wrap;
Â  Â  }
Â  Â  .searchbar {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 10px;
Â  Â  Â  align-items: center;
Â  Â  Â  flex: 1;
Â  Â  }
Â  Â  .searchbar input {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 10px 12px;
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 10px;
Â  Â  Â  font-size: 16px;
Â  Â  }
Â  Â  /* ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ï¼ˆã‚°ãƒ­ãƒ¼ãƒãƒ«ï¼‰ */
Â  Â  .filterbar {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 8px;
Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  .filterbar .label {
Â  Â  Â  font-size: 12px;
Â  Â  Â  color: var(--muted);
Â  Â  }
Â  Â  .filter-tags {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 8px;
Â  Â  Â  flex-wrap: wrap;
Â  Â  }
Â  Â  .chip-tag {
Â  Â  Â  font-size: 12px;
Â  Â  Â  line-height: 1;
Â  Â  Â  padding: 8px 12px;
Â  Â  Â  border: 1px solid #e5dfff;
Â  Â  Â  border-radius: 999px;
Â  Â  Â  background: #f0ecff;
Â  Â  Â  color: #5b55a5;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .chip-tag:hover {
Â  Â  Â  filter: brightness(0.97);
Â  Â  }
Â  Â  .chip-tag.active {
Â  Â  Â  background: var(--accent);
Â  Â  Â  border-color: var(--accent);
Â  Â  Â  color: #fff;
Â  Â  }
Â  Â  .chip-clear {
Â  Â  Â  font-size: 12px;
Â  Â  Â  padding: 6px 10px;
Â  Â  Â  border: 1px dashed var(--border);
Â  Â  Â  border-radius: 999px;
Â  Â  Â  background: #fff;
Â  Â  Â  color: #6b7280;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .chip-clear:hover {
Â  Â  Â  border-color: #c1c5e8;
Â  Â  Â  color: #4b5563;
Â  Â  }
Â  Â  /* 2ã‚«ãƒ©ãƒ  */
Â  Â  .grid {
Â  Â  Â  display: grid;
Â  Â  Â  gap: 16px;
Â  Â  Â  align-items: start;
Â  Â  Â  grid-template-columns: 1.2fr 0.8fr;
Â  Â  Â  grid-template-areas: "list player";
Â  Â  }
Â  Â  .grid.player-left {
Â  Â  Â  grid-template-columns: 0.8fr 1.2fr;
Â  Â  Â  grid-template-areas: "player list";
Â  Â  }
Â  Â  @media (max-width: 900px) {
Â  Â  Â  .grid {
Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  Â  grid-template-areas: "player" "list";
Â  Â  Â  }
Â  Â  }
Â  Â  /* è¡Œãƒªã‚¹ãƒˆ */
Â  Â  .list {
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 14px;
Â  Â  Â  overflow: hidden;
Â  Â  }
Â  Â  .row {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: minmax(180px, 2fr) 120px minmax(200px, 2fr);
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 12px;
Â  Â  Â  padding: 10px 14px;
Â  Â  Â  border-top: 1px solid var(--border);
Â  Â  Â  background: #fafafa;
Â  Â  }
Â  Â  .row:nth-child(odd) {
Â  Â  Â  background: #f6f6fb;
Â  Â  }
Â  Â  .row:first-child {
Â  Â  Â  border-top: none;
Â  Â  }
Â  Â  .songcell {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  }
Â  Â  .songtitle {
Â  Â  Â  font-weight: 600;
Â  Â  Â  display: flex;
Â  Â  Â  gap: 8px;
Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  .songtitle .note {
Â  Â  Â  font-size: 18px;
Â  Â  }
Â  Â  .artist {
Â  Â  Â  font-size: 12px;
Â  Â  Â  color: var(--muted);
Â  Â  }
Â  Â  .link {
Â  Â  Â  all: unset;
Â  Â  Â  cursor: pointer;
Â  Â  Â  color: inherit;
Â  Â  }
Â  Â  .link:hover {
Â  Â  Â  color: var(--accent);
Â  Â  Â  text-decoration: underline;
Â  Â  }
Â  Â  .link.artist {
Â  Â  Â  color: var(--muted);
Â  Â  }
Â  Â  .date {
Â  Â  Â  font-variant-numeric: tabular-nums;
Â  Â  Â  font-feature-settings: "tnum" 1;
Â  Â  Â  color: #374151;
Â  Â  Â  justify-self: end;
Â  Â  Â  text-align: right;
Â  Â  Â  width: 120px;
Â  Â  }
Â  Â  .videotitle {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 6px;
Â  Â  }
Â  Â  .videotitle button {
Â  Â  Â  all: unset;
Â  Â  Â  cursor: pointer;
Â  Â  Â  color: #111;
Â  Â  }
Â  Â  .videotitle button:hover {
Â  Â  Â  color: var(--accent);
Â  Â  Â  text-decoration: underline;
Â  Â  }
Â  Â  .ellipsis {
Â  Â  Â  white-space: nowrap;
Â  Â  Â  overflow: hidden;
Â  Â  Â  text-overflow: ellipsis;
Â  Â  }
Â  Â  .tags-row {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 6px;
Â  Â  Â  flex-wrap: wrap;
Â  Â  }
Â  Â  .tag {
Â  Â  Â  font-size: 11px;
Â  Â  Â  line-height: 1;
Â  Â  Â  padding: 6px 10px;
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 999px;
Â  Â  Â  background: #fff;
Â  Â  Â  color: #374151;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .tag:hover {
Â  Â  Â  border-color: var(--accent);
Â  Â  Â  color: var(--accent);
Â  Â  }
Â  Â  .videotitle {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 8px;
Â  Â  }
Â  Â  .tags-row {
Â  Â  Â  display: flex;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  gap: 8px;
Â  Â  Â  align-items: center;
Â  Â  Â  margin-top: 2px;
Â  Â  Â  padding-top: 6px;
Â  Â  Â  border-top: 1px dashed var(--border);
Â  Â  }
Â  Â  .tags-row::before {
Â  Â  Â  content: "ã‚¿ã‚°";
Â  Â  Â  font-size: 11px;
Â  Â  Â  color: var(--muted);
Â  Â  Â  margin-right: 4px;
Â  Â  Â  padding: 2px 6px;
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 999px;
Â  Â  Â  background: #fff;
Â  Â  }
Â  Â  .tag-badge {
Â  Â  Â  appearance: none;
Â  Â  Â  border: 0;
Â  Â  Â  cursor: pointer;
Â  Â  Â  font-size: 12px;
Â  Â  Â  line-height: 1;
Â  Â  Â  padding: 8px 12px;
Â  Â  Â  border-radius: 999px;
Â  Â  Â  background: #f2efff;
Â  Â  Â  color: #4c46a6;
Â  Â  Â  border: 1px solid #e5dfff;
Â  Â  Â  display: inline-flex;
Â  Â  Â  gap: 6px;
Â  Â  Â  align-items: center;
Â  Â  }
Â  Â  .tag-badge::before {
Â  Â  Â  content: "#";
Â  Â  Â  font-weight: 700;
Â  Â  Â  opacity: 0.6;
Â  Â  }
Â  Â  .tag-badge:hover {
Â  Â  Â  filter: brightness(0.97);
Â  Â  }
Â  Â  .tag-badge:active {
Â  Â  Â  transform: translateY(1px);
Â  Â  }
Â  Â  .tag-badge.active {
Â  Â  Â  background: var(--accent);
Â  Â  Â  border-color: var(--accent);
Â  Â  Â  color: #fff;
Â  Â  Â  box-shadow: 0 0 0 3px var(--ring);
Â  Â  }
Â  Â  @media (max-width: 900px) {
Â  Â  Â  .row {
Â  Â  Â  Â  grid-template-columns: 1fr;
Â  Â  Â  Â  align-items: start;
Â  Â  Â  }
Â  Â  Â  .date {
Â  Â  Â  Â  justify-self: start;
Â  Â  Â  }
Â  Â  Â  .videotitle {
Â  Â  Â  Â  margin-top: -4px;
Â  Â  Â  }
Â  Â  }
Â  Â  .nothing {
Â  Â  Â  color: var(--muted);
Â  Â  Â  text-align: center;
Â  Â  Â  padding: 20px;
Â  Â  Â  border: 1px dashed var(--border);
Â  Â  Â  border-radius: 12px;
Â  Â  }
Â  Â  /* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ */
Â  Â  .player-panel {
Â  Â  Â  position: sticky;
Â  Â  Â  top: 84px;
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 14px;
Â  Â  Â  overflow: hidden;
Â  Â  Â  background: var(--panel);
Â  Â  }
Â  Â  .player-head {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  Â  padding: 10px 14px;
Â  Â  Â  background: #f0f1ff;
Â  Â  Â  border-bottom: 1px solid var(--border);
Â  Â  }
Â  Â  .player-head .drag-handle {
Â  Â  Â  font-weight: 700;
Â  Â  Â  opacity: 0.5;
Â  Â  Â  padding: 0 6px;
Â  Â  Â  border-radius: 6px;
Â  Â  }
Â  Â  .player-panel.is-float .player-head:active {
Â  Â  Â  cursor: grabbing;
Â  Â  }
Â  Â  .player-title {
Â  Â  Â  font-size: 14px;
Â  Â  Â  color: #333;
Â  Â  Â  white-space: nowrap;
Â  Â  Â  overflow: hidden;
Â  Â  Â  text-overflow: ellipsis;
Â  Â  }
Â  Â  .player-sub {
Â  Â  Â  font-size: 12px;
Â  Â  Â  color: var(--muted);
Â  Â  }
Â  Â  .player-body {
Â  Â  Â  position: relative;
Â  Â  Â  aspect-ratio: 16/9;
Â  Â  Â  width: 100%;
Â  Â  Â  background: #000;
Â  Â  }
Â  Â  .player-body iframe {
Â  Â  Â  position: absolute;
Â  Â  Â  inset: 0;
Â  Â  Â  width: 100%;
Â  Â  Â  height: 100%;
Â  Â  Â  border: 0;
Â  Â  }
Â  Â  .player-foot {
Â  Â  Â  padding: 10px 14px;
Â  Â  Â  border-top: 1px solid var(--border);
Â  Â  Â  background: #fff;
Â  Â  }
Â  Â  .meta-line {
Â  Â  Â  display: flex;
Â  Â  Â  gap: 8px;
Â  Â  Â  align-items: center;
Â  Â  Â  flex-wrap: wrap;
Â  Â  Â  margin-bottom: 8px;
Â  Â  }
Â  Â  .setlist {
Â  Â  Â  max-height: 420px;
Â  Â  Â  overflow: auto;
Â  Â  Â  border: 1px solid var(--border);
Â  Â  Â  border-radius: 10px;
Â  Â  Â  margin-top: 8px;
Â  Â  }
Â  Â  .set-item {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  gap: 12px;
Â  Â  Â  padding: 10px 12px;
Â  Â  Â  border-top: 1px solid var(--border);
Â  Â  Â  background: #fafafa;
Â  Â  Â  cursor: pointer;
Â  Â  }
Â  Â  .set-item:first-child {
Â  Â  Â  border-top: none;
Â  Â  }
Â  Â  .set-item:hover {
Â  Â  Â  background: #f3f4ff;
Â  Â  }
Â  Â  .set-item.active {
Â  Â  Â  background: #e9ecff;
Â  Â  }
Â  Â  .set-title {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  }
Â  Â  .set-song {
Â  Â  Â  font-weight: 600;
Â  Â  }
Â  Â  .set-artist {
Â  Â  Â  font-size: 12px;
Â  Â  Â  color: var(--muted);
Â  Â  }
Â  Â  .set-time {
Â  Â  Â  font-variant-numeric: tabular-nums;
Â  Â  Â  color: #374151;
Â  Â  Â  white-space: nowrap;
Â  Â  }
Â  Â  .warn {
Â  Â  Â  margin-top: 8px;
Â  Â  Â  padding: 10px 12px;
Â  Â  Â  color: #92400e;
Â  Â  Â  background: #fff7ed;
Â  Â  Â  border: 1px solid #fed7aa;
Â  Â  Â  border-radius: 8px;
Â  Â  }
Â  Â  /* ===== ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼è¿½å¾“ï¼ˆãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼‰ï¼†ãƒ¢ãƒã‚¤ãƒ«æµ®å‹•ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ ===== */
Â  Â  /* ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ï¼šã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«è¿½å¾“ */
Â  Â  @media (min-width: 901px) {
Â  Â  Â  .player-col {
Â  Â  Â  Â  position: sticky;
Â  Â  Â  Â  top: 84px;
Â  Â  Â  Â  align-self: start;
Â  Â  Â  Â  height: fit-content;
Â  Â  Â  Â  z-index: 5;
Â  Â  Â  }
Â  Â  Â  .player-panel {
Â  Â  Â  Â  position: static;
Â  Â  Â  }
Â  Â  }
Â  Â  /* ãƒ¢ãƒã‚¤ãƒ«ï¼šå³ä¸‹ã«å°ã•ãªå¸¸æ™‚è¡¨ç¤ºãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ */
Â  Â  @media (max-width: 900px) {
Â  Â  Â  body.has-float {
Â  Â  Â  Â  padding-bottom: 220px;
Â  Â  Â  }
Â  Â  Â  .player-panel.is-float {
Â  Â  Â  Â  position: fixed;
Â  Â  Â  Â  right: 12px;
Â  Â  Â  Â  bottom: 12px;
Â  Â  Â  Â  width: min(92vw, 360px);
Â  Â  Â  Â  z-index: 1000;
Â  Â  Â  Â  box-shadow: 0 12px 32px rgba(0, 0, 0, 0.28);
Â  Â  Â  Â  border-radius: 14px;
Â  Â  Â  Â  overflow: hidden;
Â  Â  Â  Â  background: var(--panel, #fff);
Â  Â  Â  }
Â  Â  Â  .player-panel.is-float .player-head {
Â  Â  Â  Â  display: flex;
Â  Â  Â  Â  align-items: center;
Â  Â  Â  Â  padding: 6px 10px;
Â  Â  Â  Â  gap: 8px;
Â  Â  Â  Â  height: 36px;
Â  Â  Â  Â  cursor: grab;
Â  Â  Â  Â  user-select: none;
Â  Â  Â  }
Â  Â  Â  .player-panel.is-float .player-body {
Â  Â  Â  Â  aspect-ratio: 16/9;
Â  Â  Â  }
Â  Â  Â  .player-panel.is-float .player-foot {
Â  Â  Â  Â  display: block;
Â  Â  Â  Â  max-height: 40vh;
Â  Â  Â  Â  overflow: auto;
Â  Â  Â  Â  border-top: 1px solid #eee;
Â  Â  Â  }
Â  Â  Â  .player-panel.is-float .setlist .item {
Â  Â  Â  Â  padding: 10px 12px;
Â  Â  Â  Â  font-size: 14px;
Â  Â  Â  Â  line-height: 1.25;
Â  Â  Â  }
Â  Â  Â  .player-panel.is-float .player-body {
Â  Â  Â  Â  aspect-ratio: 16/9;
Â  Â  Â  }
Â  Â  }
Â  Â  .list-col {
Â  Â  Â  grid-area: list;
Â  Â  }
Â  Â  .player-col {
Â  Â  Â  grid-area: player;
Â  Â  }
Â  Â  /* ãŠæ°—ã«å…¥ã‚Šãƒœã‚¿ãƒ³ã®ã‚¹ã‚¿ã‚¤ãƒ« */
Â  Â  .favorite-btn {
Â  Â  Â  all: unset;
Â  Â  Â  cursor: pointer;
Â  Â  Â  padding: 0;
Â  Â  Â  margin-left: 8px;
Â  Â  }
Â  Â  .star-icon {
Â  Â  Â  font-size: 20px;
Â  Â  Â  color: #ccc;
Â  Â  Â  transition: color 0.2s ease;
Â  Â  }
Â  Â  .favorite-btn.is-favorited .star-icon {
Â  Â  Â  color: #ffd700;
Â  Â  Â  text-shadow: 0 0 5px rgba(255, 215, 0, 0.5);
Â  Â  }
Â  </style>
</head>
<body>
Â  <header>
Â  Â  <div class="wrap" style="display:flex;align-items:center;justify-content:space-between;gap:20px">
Â  Â  Â  <a href="../index.html" class="brand" aria-label="HOME">
Â  Â  Â  <span style="font-weight:700;color:#4c46a6">HOME</span>
Â  Â  </a>
Â  Â  Â  <h1>ğŸµ é•·å°¾æ™¯ æ›²æ¤œç´¢</h1>
Â  Â  Â  <div class="toolbar">
Â  Â  Â  Â  <div class="searchbar"><input id="q" type="search" placeholder="æ›²åãƒ»ã‚¢ãƒ¼ãƒ†ã‚£ã‚¹ãƒˆãƒ»å‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«ãƒ»ã‚¿ã‚°ã§æ¤œç´¢" autocomplete="off" /></div>
Â  Â  Â  Â  <div class="filterbar">
Â  Â  Â  Â  Â  <span class="label">ã‚¿ã‚°ã§çµã‚Šè¾¼ã¿ï¼š</span>
Â  Â  Â  Â  Â  <div id="filterTags" class="filter-tags"></div>
Â  Â  Â  Â  Â  <button id="filterFavorites" class="chip-tag" type="button" style="display:none">â˜… ãŠæ°—ã«å…¥ã‚Š</button>
Â  Â  Â  Â  Â  <button id="clearTags" class="chip-clear" type="button" style="display:none">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼è§£é™¤</button>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  </header>

Â  <main class="wrap">
Â  Â  <div id="grid" class="grid player-left">
Â  Â  Â  <section class="list-col">
Â  Â  Â  Â  <div id="list" class="list"></div>
Â  Â  Â  Â  <div id="empty" class="nothing" style="display:none">è©²å½“ã™ã‚‹çµæœãŒã‚ã‚Šã¾ã›ã‚“ã€‚</div>
Â  Â  Â  </section>
Â  Â  Â  <aside class="player-col">
Â  Â  Â  Â  <div class="player-panel" id="playerPanel" style="display:none">
Â  Â  Â  Â  Â  <div class="player-head">
Â  Â  Â  Â  Â  Â  <span class="drag-handle" aria-label="Move">â‰¡</span>
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <div class="player-title" id="playerTitle">ï¼ˆå‹•ç”»ã‚¿ã‚¤ãƒˆãƒ«ï¼‰</div>
Â  Â  Â  Â  Â  Â  Â  <div class="player-sub" id="playerMeta">YYYY.MM.DD / ãƒãƒ£ãƒ³ãƒãƒ«å</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div style="display:flex;gap:8px;align-items:center"><a id="openYT" href="#" target="_blank" rel="noopener" style="font-size:12px;color:var(--accent);text-decoration:none">YouTubeã§é–‹ã â†—</a></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="player-body"><iframe id="ytFrame" src="about:blank" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen referrerpolicy="strict-origin-when-cross-origin"></iframe></div>
Â  Â  Â  Â  Â  <div class="player-foot">
Â  Â  Â  Â  Â  Â  <div class="meta-line"><strong>ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆ</strong></div>
Â  Â  Â  Â  Â  Â  <div class="setlist" id="setlist"></div>
Â  Â  Â  Â  Â  Â  <div id="embedWarn" class="warn" style="display:none">ã“ã®å‹•ç”»ã¯ãƒšãƒ¼ã‚¸å†…å†ç”ŸãŒè¨±å¯ã•ã‚Œã¦ã„ãªã„å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚<a id="warnLink" href="#" target="_blank" rel="noopener">YouTubeã§é–‹ã</a> ã‚’ãŠè©¦ã—ãã ã•ã„ã€‚</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </aside>
Â  Â  </div>
Â  </main>

Â  <script src="https://www.youtube.com/iframe_api"></script>
Â  <script>
Â  Â  const $list = document.getElementById('list');
Â  Â  const $empty = document.getElementById('empty');
Â  Â  const $q = document.getElementById('q');
Â  Â  const $grid = document.getElementById('grid');
Â  Â  const $filterTags = document.getElementById('filterTags');
Â  Â  const $clearTags = document.getElementById('clearTags');
Â  Â  const $filterFavorites = document.getElementById('filterFavorites');
Â  Â  let filterByFavorites = false;

Â  Â  const $panel = document.getElementById('playerPanel');
Â  Â  const $yt = document.getElementById('ytFrame');
Â  Â  const $title = document.getElementById('playerTitle');
Â  Â  const $meta = document.getElementById('playerMeta');
Â  Â  const $open = document.getElementById('openYT');
Â  Â  const $warn = document.getElementById('embedWarn');
Â  Â  const $warnLink = document.getElementById('warnLink');
Â  Â  const $setlist = document.getElementById('setlist');

Â  Â  const pad = n => String(n).padStart(2, '0');
Â  Â  const ymdToDots = ymd => { const [y, m, d] = (ymd || '').split('-'); return y ? `${y}.${pad(m)}.${pad(d)}` : ''; };
Â  Â  const FAVORITES_KEY = 'favorites';
Â  Â  function fillSearch(text) { if (!text) return; $q.value = text; applyFilter(); }

Â  Â  function toSeconds(v) {
Â  Â  Â  if (v == null) return 0;
Â  Â  Â  if (typeof v === 'number') return Math.max(0, v | 0);
Â  Â  Â  if (/^\d+$/.test(v)) return Math.max(0, parseInt(v, 10));
Â  Â  Â  const p = String(v).split(':').map(Number);
Â  Â  Â  if (p.length === 3) return p[0] * 3600 + p[1] * 60 + p[2];
Â  Â  Â  if (p.length === 2) return p[0] * 60 + p[1];
Â  Â  Â  return 0;
Â  Â  }
Â  Â  const hms = sec => { sec = toSeconds(sec); const h = Math.floor(sec / 3600), m = Math.floor(sec % 3600 / 60), s = Math.floor(sec % 60); return `${pad(h)}:${pad(m)}:${pad(s)}`; };

Â  Â  let player = null, apiReady = false;
Â  Â  window.onYouTubeIframeAPIReady = () => { apiReady = true; };
Â  Â  function loadVideo(id, start = 0) {
Â  Â  Â  $warn.style.display = 'none';
Â  Â  Â  const startSec = toSeconds(start);
Â  Â  Â  const url = `https://www.youtube.com/embed/${id}?start=${startSec}&autoplay=1&rel=0&modestbranding=1&playsinline=1&enablejsapi=1`;

Â  Â  Â  if (apiReady) {
Â  Â  Â  Â  if (!player) {
Â  Â  Â  Â  Â  player = new YT.Player('ytFrame', {
Â  Â  Â  Â  Â  Â  playerVars: { rel: 0, modestbranding: 1, playsinline: 1 },
Â  Â  Â  Â  Â  Â  events: { onError: () => ($warn.style.display = 'block') }
Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  player.loadVideoById({ videoId: id, startSeconds: startSec });
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  } catch (e) { }
Â  Â  Â  }
Â  Â  Â  $yt.src = url;
Â  Â  }

Â  Â  function normalizeVideos(videos) {
Â  Â  Â  const map = new Map();
Â  Â  Â  for (const raw of videos) {
Â  Â  Â  Â  const v = { ...raw };
Â  Â  Â  Â  const id = v.youtubeId;
Â  Â  Â  Â  const songs = (v.songs || v.setlist || []).map(s => ({
Â  Â  Â  Â  Â  title: s.title || s.song || '',
Â  Â  Â  Â  Â  artist: s.artist || s.singer || 'ï¼ˆä¸æ˜ï¼‰',
Â  Â  Â  Â  Â  start: toSeconds(s.start ?? s.time ?? s.begin ?? 0)
Â  Â  Â  Â  }));
Â  Â  Â  Â  const tags = Array.isArray(v.tags) ? v.tags.filter(Boolean) : [];
Â  Â  Â  Â  if (!map.has(id)) {
Â  Â  Â  Â  Â  map.set(id, { title: v.title || '', date: v.date || '', channel: v.channel || '', youtubeId: id || '', songs: [], tags: [] });
Â  Â  Â  Â  }
Â  Â  Â  Â  const bucket = map.get(id);
Â  Â  Â  Â  for (const s of songs) { const key = `${s.title}__${s.artist}__${s.start}`; if (!bucket.songs.some(t => `${t.title}__${t.artist}__${t.start}` === key)) bucket.songs.push(s); }
Â  Â  Â  Â  bucket.tags = Array.from(new Set([...(bucket.tags || []), ...tags]));
Â  Â  Â  }
Â  Â  Â  for (const v of map.values()) { v.songs.sort((a, b) => a.start - b.start); }
Â  Â  Â  return [...map.values()];
Â  Â  }

Â  Â  let ALL_ROWS = []; let VIDEO_MAP = new Map(); let ALL_TAGS = []; const SELECTED_TAGS = new Set();
Â  Â  function buildRows(videos) {
Â  Â  Â  const merged = normalizeVideos(videos);
Â  Â  Â  VIDEO_MAP = new Map(merged.map(v => [v.youtubeId, v]));
Â  Â  Â  ALL_ROWS = [];
Â  Â  Â  for (const v of merged) {
Â  Â  Â  Â  for (const s of v.songs) {
Â  Â  Â  Â  Â  ALL_ROWS.push({ song: s.title, artist: s.artist, date: v.date, videoTitle: v.title, youtubeId: v.youtubeId, start: s.start, tags: v.tags || [], tagsText: (v.tags || []).join(' ') });
Â  Â  Â  Â  }
Â  Â  Â  }
Â  Â  Â  ALL_ROWS.sort((a, b) => { if (a.date !== b.date) return a.date < b.date ? 1 : -1; const s = a.song.localeCompare(b.song, 'ja'); if (s) return s; return a.artist.localeCompare(b.artist, 'ja'); });
Â  Â  Â  ALL_TAGS = Array.from(new Set(merged.flatMap(v => v.tags || []))).sort((a, b) => a.localeCompare(b, 'ja'));
Â  Â  Â  renderFilterTags();
Â  Â  }

Â  Â  function getFavorites() {
Â  Â  Â  const favorites = localStorage.getItem(FAVORITES_KEY);
Â  Â  Â  return favorites ? JSON.parse(favorites) : [];
Â  Â  }

Â  Â  function saveFavorites(favorites) {
Â  Â  Â  localStorage.setItem(FAVORITES_KEY, JSON.stringify(favorites));
Â  Â  }

Â  Â  function renderFilterTags() {
Â  Â  Â  const favorites = getFavorites();
Â  Â  Â  $filterFavorites.style.display = favorites.length > 0 ? '' : 'none';
Â  Â  Â  $filterFavorites.classList.toggle('active', filterByFavorites);
Â  Â  Â  $filterTags.innerHTML = '';
Â  Â  Â  if (!ALL_TAGS.length && favorites.length === 0) {
Â  Â  Â  Â  $filterTags.parentElement.style.display = 'none';
Â  Â  Â  Â  $clearTags.style.display = 'none';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  $filterTags.parentElement.style.display = '';
Â  Â  Â  for (const t of ALL_TAGS) {
Â  Â  Â  Â  const b = document.createElement('button');
Â  Â  Â  Â  b.className = 'chip-tag' + (SELECTED_TAGS.has(t) ? ' active' : '');
Â  Â  Â  Â  b.type = 'button'; b.textContent = t;
Â  Â  Â  Â  b.addEventListener('click', () => {
Â  Â  Â  Â  Â  filterByFavorites = false;
Â  Â  Â  Â  Â  if (SELECTED_TAGS.has(t)) SELECTED_TAGS.delete(t);
Â  Â  Â  Â  Â  else SELECTED_TAGS.add(t);
Â  Â  Â  Â  Â  renderFilterTags();
Â  Â  Â  Â  Â  applyFilter();
Â  Â  Â  Â  });
Â  Â  Â  Â  $filterTags.appendChild(b);
Â  Â  Â  }
Â  Â  Â  $clearTags.style.display = (SELECTED_TAGS.size > 0 || filterByFavorites) ? 'inline-block' : 'none';
Â  Â  }

Â  Â  $clearTags.addEventListener('click', () => {
Â  Â  Â  SELECTED_TAGS.clear();
Â  Â  Â  filterByFavorites = false;
Â  Â  Â  renderFilterTags();
Â  Â  Â  applyFilter();
Â  Â  });

Â  Â  $filterFavorites.addEventListener('click', () => {
Â  Â  Â  filterByFavorites = !filterByFavorites;
Â  Â  Â  SELECTED_TAGS.clear();
Â  Â  Â  renderFilterTags();
Â  Â  Â  applyFilter();
Â  Â  });

Â  Â  function renderRows(rows) {
Â  Â  Â  $list.innerHTML = '';
Â  Â  Â  if (!rows.length) { $empty.style.display = 'block'; return; }
Â  Â  Â  $empty.style.display = 'none';
Â  Â  Â  for (const r of rows) {
Â  Â  Â  Â  const div = document.createElement('div');
Â  Â  Â  Â  div.className = 'row';
Â  Â  Â  Â  const songKey = `${r.youtubeId}-${r.start}`;

Â  Â  Â  Â  div.innerHTML = `
Â  Â  Â  Â  Â  <div class="songcell">
Â  Â  Â  Â  Â  Â  <div class="songtitle ellipsis">
Â  Â  Â  Â  Â  Â  Â  <span class="note">ğŸµ</span>
Â  Â  Â  Â  Â  Â  Â  <button class="link song" type="button">${r.song}</button>
Â  Â  Â  Â  Â  Â  Â  <button class="favorite-btn" aria-label="ãŠæ°—ã«å…¥ã‚Šã«è¿½åŠ /å‰Šé™¤">
Â  Â  Â  Â  Â  Â  Â  Â  <span class="star-icon">â˜†</span>
Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="artist ellipsis"><button class="link artist" type="button">${r.artist}</button></div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="date">${ymdToDots(r.date)}</div>
Â  Â  Â  Â  Â  <div class="videotitle">
Â  Â  Â  Â  Â  Â  <div class="ellipsis">
Â  Â  Â  Â  Â  Â  Â  <button type="button" data-id="${r.youtubeId}" data-start="${r.start}" data-title="${r.videoTitle.replace(/"/g, '&quot;')}" data-date="${r.date}">${r.videoTitle}</button>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="tags-row"></div>
Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  Â  
        const favBtn = div.querySelector('.favorite-btn');
        if (getFavorites().includes(songKey)) {
            favBtn.classList.add('is-favorited');
        }
        favBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            const currentFavorites = getFavorites();
            const index = currentFavorites.indexOf(songKey);
            if (index > -1) {
                currentFavorites.splice(index, 1);
                favBtn.classList.remove('is-favorited');
            } else {
                currentFavorites.push(songKey);
                favBtn.classList.add('is-favorited');
            }
            saveFavorites(currentFavorites);
            // ãŠæ°—ã«å…¥ã‚Šãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãŒæœ‰åŠ¹ãªå ´åˆã¯å†ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
            if (filterByFavorites) {
                applyFilter();
            }
        });

Â  Â  Â  Â  div.querySelector('.song').addEventListener('click', () => fillSearch(r.song));
Â  Â  Â  Â  div.querySelector('.artist').addEventListener('click', () => fillSearch(r.artist));
Â  Â  Â  Â  const rowTagBox = div.querySelector('.tags-row');
Â  Â  Â  Â  const tags = (VIDEO_MAP.get(r.youtubeId)?.tags) || r.tags || [];
Â  Â  Â  Â  tags.forEach(t => { const b = document.createElement('button'); b.className = 'tag-badge'; b.type = 'button'; b.textContent = t; b.addEventListener('click', () => fillSearch(t)); rowTagBox.appendChild(b); });
Â  Â  Â  Â  div.querySelector('.videotitle button').addEventListener('click', e => {
Â  Â  Â  Â  Â  const id = e.currentTarget.dataset.id; const start = e.currentTarget.dataset.start; const title = e.currentTarget.dataset.title; const date = e.currentTarget.dataset.date; const video = VIDEO_MAP.get(id) || { songs: [], tags: [] };
Â  Â  Â  Â  Â  $title.textContent = `${title}${start ? `ï¼ˆ${hms(start)}ã€œï¼‰` : ''}`;
Â  Â  Â  Â  Â  $meta.textContent = `${ymdToDots(date)} / ${video.channel || ''}`;
Â  Â  Â  Â  Â  $open.href = `https://www.youtube.com/watch?v=${id}&t=${toSeconds(start)}s`;
Â  Â  Â  Â  Â  $warnLink.href = $open.href;
Â  Â  Â  Â  Â  renderSetlist(video, id, toSeconds(start));
Â  Â  Â  Â  Â  loadVideo(id, start);
Â  Â  Â  Â  Â  $panel.style.display = 'block';
Â  Â  Â  Â  Â  updateFloatOnPlay();
Â  Â  Â  Â  Â  $panel.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
Â  Â  Â  Â  });
Â  Â  Â  Â  $list.appendChild(div);
Â  Â  Â  }
Â  Â  }

Â  Â  function renderSetlist(video, id, activeStart) {
Â  Â  Â  $setlist.innerHTML = '';
Â  Â  Â  if (!video.songs || video.songs.length === 0) {
Â  Â  Â  Â  $setlist.innerHTML = '<div style="padding:10px;text-align:center;color:#6b7280;">ã‚»ãƒƒãƒˆãƒªã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“</div>';
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  for (const s of (video.songs || [])) {
Â  Â  Â  Â  const sec = toSeconds(s.start);
Â  Â  Â  Â  const item = document.createElement('div');
Â  Â  Â  Â  item.className = 'set-item' + (sec === activeStart ? ' active' : '');
Â  Â  Â  Â  item.innerHTML = `<div class="set-title"><div class="set-song">${s.title}</div><div class="set-artist">${s.artist}</div></div><div class="set-time">${hms(sec)}ã€œ</div>`;
Â  Â  Â  Â  item.addEventListener('click', () => {
Â  Â  Â  Â  Â  loadVideo(id, sec);
Â  Â  Â  Â  Â  $title.textContent = `${video.title}ï¼ˆ${hms(sec)}ã€œï¼‰`;
Â  Â  Â  Â  Â  $open.href = `https://www.youtube.com/watch?v=${id}&t=${sec}s`;
Â  Â  Â  Â  Â  [...$setlist.children].forEach(el => el.classList.remove('active'));
Â  Â  Â  Â  Â  item.classList.add('active');
Â  Â  Â  Â  });
Â  Â  Â  Â  $setlist.appendChild(item);
Â  Â  Â  }
Â  Â  }

Â  Â  function applyFilter() {
Â  Â  Â  let filteredRows;
Â  Â  Â  if (filterByFavorites) {
Â  Â  Â  Â  const favorites = getFavorites();
Â  Â  Â  Â  filteredRows = ALL_ROWS.filter(r => favorites.includes(`${r.youtubeId}-${r.start}`));
Â  Â  Â  } else {
Â  Â  Â  Â  const q = ($q.value || '').trim().toLowerCase();
Â  Â  Â  Â  const selected = [...SELECTED_TAGS];
Â  Â  Â  Â  filteredRows = ALL_ROWS.filter(r => {
Â  Â  Â  Â  Â  const textOk = !q || r.song.toLowerCase().includes(q) || r.artist.toLowerCase().includes(q) || r.videoTitle.toLowerCase().includes(q) || (r.tagsText || '').toLowerCase().includes(q);
Â  Â  Â  Â  Â  const tagOk = !selected.length || selected.some(t => (r.tags || []).includes(t));
Â  Â  Â  Â  Â  return textOk && tagOk;
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  Â  renderRows(filteredRows);
Â  Â  }

Â  Â  fetch('videos.json')
Â  Â  Â  .then(r => r.json())
Â  Â  Â  .then(videos => {
Â  Â  Â  Â  buildRows(videos);
Â  Â  Â  Â  applyFilter();
Â  Â  Â  })
Â  Â  Â  .catch(err => {
Â  Â  Â  Â  console.error(err);
Â  Â  Â  Â  $empty.style.display = 'block';
Â  Â  Â  Â  $empty.textContent = 'videos.json ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ã”ç¢ºèªãã ã•ã„ã€‚';
Â  Â  Â  });

Â  Â  $q.addEventListener('keydown', e => { if (e.key === 'Enter') applyFilter(); });
Â  Â  $q.addEventListener('search', applyFilter);
Â  Â  $q.addEventListener('input', applyFilter);

Â  Â  (function () {
Â  Â  Â  const mq = window.matchMedia('(max-width: 900px)');
Â  Â  Â  const headerH = 84;
Â  Â  Â  const $playerCol = document.querySelector('.player-col');

Â  Â  Â  function setFloat(enable) {
Â  Â  Â  Â  const canFloat = enable && $panel.style.display !== 'none';
Â  Â  Â  Â  document.body.classList.toggle('has-float', canFloat);
Â  Â  Â  Â  $panel.classList.toggle('is-float', canFloat);
Â  Â  Â  }

Â  Â  Â  let io = null;
Â  Â  Â  function attachObserver() {
Â  Â  Â  Â  if (io) { io.disconnect(); io = null; }
Â  Â  Â  Â  if (!mq.matches) { setFloat(false); return; }
Â  Â  Â  Â  io = new IntersectionObserver((entries) => {
Â  Â  Â  Â  Â  for (const e of entries) {
Â  Â  Â  Â  Â  Â  const visible = e.isIntersecting && e.intersectionRatio > 0.6;
Â  Â  Â  Â  Â  Â  setFloat(!visible);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }, { root: null, rootMargin: `-${headerH + 8}px 0px 0px 0px`, threshold: [0, 0.6, 1] });
Â  Â  Â  Â  io.observe($playerCol);
Â  Â  Â  }

Â  Â  Â  mq.addEventListener('change', attachObserver);
Â  Â  Â  window.addEventListener('orientationchange', attachObserver);
Â  Â  Â  window.addEventListener('resize', attachObserver);
Â  Â  Â  window.addEventListener('load', attachObserver);

Â  Â  Â  window.updateFloatOnPlay = function () {
Â  Â  Â  Â  attachObserver();
Â  Â  Â  };
Â  Â  })();

Â  Â  (function () {
Â  Â  Â  const panel = document.getElementById('playerPanel');
Â  Â  Â  const head = panel?.querySelector('.player-head');
Â  Â  Â  if (!panel || !head) return;
Â  Â  Â  let dragging = false, startX = 0, startY = 0, startLeft = 0, startTop = 0;

Â  Â  Â  function px(n) { return `${Math.round(n)}px`; }
Â  Â  Â  function onDown(e) {
Â  Â  Â  Â  if (!panel.classList.contains('is-float')) return;
Â  Â  Â  Â  dragging = true;
Â  Â  Â  Â  const rect = panel.getBoundingClientRect();
Â  Â  Â  Â  startLeft = rect.left; startTop = rect.top;
Â  Â  Â  Â  const p = (e.touches?.[0] || e);
Â  Â  Â  Â  startX = p.clientX; startY = p.clientY;
Â  Â  Â  Â  panel.style.right = 'auto'; panel.style.bottom = 'auto';
Â  Â  Â  Â  panel.style.left = px(startLeft);
Â  Â  Â  Â  panel.style.top = px(startTop);
Â  Â  Â  Â  document.addEventListener('mousemove', onMove);
Â  Â  Â  Â  document.addEventListener('touchmove', onMove, { passive: false });
Â  Â  Â  Â  document.addEventListener('mouseup', onUp);
Â  Â  Â  Â  document.addEventListener('touchend', onUp);
Â  Â  Â  }
Â  Â  Â  function onMove(e) {
Â  Â  Â  Â  if (!dragging) return;
Â  Â  Â  Â  const p = (e.touches?.[0] || e);
Â  Â  Â  Â  const dx = p.clientX - startX;
Â  Â  Â  Â  const dy = p.clientY - startY;
Â  Â  Â  Â  const vw = window.innerWidth, vh = window.innerHeight;
Â  Â  Â  Â  const r = panel.getBoundingClientRect();
Â  Â  Â  Â  let L = startLeft + dx, T = startTop + dy;
Â  Â  Â  Â  L = Math.min(vw - r.width - 8, Math.max(8, L));
Â  Â  Â  Â  T = Math.min(vh - r.height - 8, Math.max(8, T));
Â  Â  Â  Â  panel.style.left = px(L);
Â  Â  Â  Â  panel.style.top = px(T);
Â  Â  Â  Â  e.preventDefault?.();
Â  Â  Â  }
Â  Â  Â  function onUp() {
Â  Â  Â  Â  dragging = false;
Â  Â  Â  Â  document.removeEventListener('mousemove', onMove);
Â  Â  Â  Â  document.removeEventListener('touchmove', onMove);
Â  Â  Â  Â  document.removeEventListener('mouseup', onUp);
Â  Â  Â  Â  document.removeEventListener('touchend', onUp);
Â  Â  Â  }
Â  Â  Â  head.addEventListener('mousedown', onDown);
Â  Â  Â  head.addEventListener('touchstart', onDown, { passive: true });
Â  Â  })();

Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  const q = new URLSearchParams(location.search).get('q') || '';
Â  Â  Â  const $input = document.querySelector('#q') || document.querySelector('input[name="q"]') || document.querySelector('input[type="search"]');
Â  Â  Â  if ($input && q) {
Â  Â  Â  Â  $input.value = q;
Â  Â  Â  Â  $input.dispatchEvent(new Event('input', { bubbles: true }));
Â  Â  Â  }
Â  Â  Â  if (typeof apply === 'function') {
Â  Â  Â  Â  apply();
Â  Â  Â  } else if (typeof runSearch === 'function') {
Â  Â  Â  Â  runSearch(q);
Â  Â  Â  }
Â  Â  });

Â  Â  (function () {
Â  Â  Â  const params = new URLSearchParams(location.search);
Â  Â  Â  const initialQ = (params.get("q") || "").trim();
Â  Â  Â  const getInput = () => document.querySelector("#q") || document.querySelector('input[name="q"]') || document.querySelector('input[type="search"]');
Â  Â  Â  function fireSearch(q) {
Â  Â  Â  Â  const $in = getInput();
Â  Â  Â  Â  if ($in) {
Â  Â  Â  Â  Â  if (q) $in.value = q;
Â  Â  Â  Â  Â  $in.dispatchEvent(new Event("input", { bubbles: true }));
Â  Â  Â  Â  }
Â  Â  Â  Â  if (typeof apply === "function") apply();
Â  Â  Â  Â  if (typeof runSearch === "function") runSearch(q || ($in && $in.value) || "");
Â  Â  Â  Â  if (typeof render === "function") render();
Â  Â  Â  }
Â  Â  Â  if (!initialQ) return;
Â  Â  Â  window.addEventListener("app:ready", () => fireSearch(initialQ), { once: true });
Â  Â  Â  const startedAt = performance.now();
Â  Â  Â  (function waitReady() {
Â  Â  Â  Â  const ready = typeof apply === "function" || typeof runSearch === "function" || typeof render === "function";
Â  Â  Â  Â  if (ready) return fireSearch(initialQ);
Â  Â  Â  Â  if (performance.now() - startedAt > 3000) return fireSearch(initialQ);
Â  Â  Â  Â  requestAnimationFrame(waitReady);
Â  Â  Â  })();
Â  Â  Â  window.addEventListener("load", () => {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  const url = new URL(location.href);
Â  Â  Â  Â  Â  url.searchParams.delete("q");
Â  Â  Â  Â  Â  history.replaceState(null, "", url);
Â  Â  Â  Â  } catch (_) { }
Â  Â  Â  });
Â  Â  })();
Â  </script>
</body>
</html>
